## JSON 动态列表参数对照表

现在页面制作只支持列表页，配置也都要自己手动输入，同时开发过程中不断添加个性化页面配置、公共模块。

如果你需要添加自定义模块的话，需要clone页面预览的代码，然后src/components/widget/ 下面自行添加组件

- 页面制作：http://47.119.113.172/page-making

## 1.概述

此文档是动态组件 JSON 参数说明文档，作为本项目动态页面组件对接的标准依据。

## 2. JSON 配置

#### 2.1 根结构

`pagination` 是否分页加载，默认为分页加载，且高度占满屏幕；否则组件自动适应高度

- 若列表仅为页面的一个组件，且需要分页显示，即列表组件需要指定高度，且通过动态页面配置子组件中的`container` 属性进行设计

| 属性            | 说明                            | 默认值               |
| --------------- | ------------------------------- | -------------------- |
| loadApi         | 获取业务数据                    |                      |
| columns         | 设置展示列数，暂支持两列  如 columns=2 | 只展示一列则不用设置columns  |
| tabConfig       | Tab数据过滤                     | {}                   |
| response        | 返回数据过滤处理                | {}                   |
| response.list   | 列表的数据位置                  | {}                   |
| response.total  | `total`字段在返回数据中的字段 | {}                   |
| request         | 业务数据查询条件                | {}                   |
| itemModule      | 列表项组件 (原生代码)           | {}                   |
| itemModule.type | 列表项组件类型                  | `custom_component` |
| itemModule.name | 列表项组件名称 (索引原生组件)   |                      |
| itemNavigation  | 列表项跳转                      | `/?id=`            |
| binding         | 列表项组件与列表数据绑定        | {}                   |
| pagination      | 是否分页加载                    | true                 |
| itemLayout      | 列表项布局，目前仅支持 [default, wrap], default 只展示一列, wrap 由列表项大小决定展示多少列| 
| newItemModule   | 列表项组件 (原生代码) | {} |
| newItemModule.name | 新增列表项组件，对应一个组件名称 (索引原生组件) |  |
| newItemModule.navigation | 新增组件路由 |  |

##### 2.1.1  `itemNavigation` 列表项路由

- 路由信息可以直接填`id`, 通过id 获取配置数据, 然后重新加载页面; 格式为`/?id={id}`
- 路由信息也可以填页面路径位置 (页面在原生代码中的文件名称); 格式为`"itemNavigation": "/articleDetail/index?id=&title"`
- 路由参数值可以不传 (如`id=`不设置值)，不传则从列表项获取; 传值则直接获取

#### 2.2 tabConfig 配置

| 属性          | 说明                   | 默认值 |
| ------------- | ---------------------- | ------ |
| field         | 对应过滤参数的某个字段 |        |
| show          | 是否显示tab栏          | true   |
| list          | 对应tab列表            | []     |
| list[0].name  | 对应tab列表项名称      |        |
| list[0].value | 用于查询的过滤值       |        |

#### 2.3 request 配置

| 属性    | 说明                             | 默认值       |
| ------- | -------------------------------- | ------------ |
| fixed   | 从 `url`上读取下来的过滤参数   |              |
| default | 对应 `fixed`字段定义的默认参数 | {}           |
| pn      | 对应接口页码字段                 | `pageNo`   |
| ps      | 对应接口每页返回条数字段         | `pageSize` |

##### 2.3.1 default 配置如下

```json
{
  "fixed": "type",
  "default": 
  {
      "type": "0"
  },
  "pn": "pageNo",
  "ps": "pageSize"
}
```

#### 2.4 `response` 响应字段

`type.list`, `type.total` 表明要渲染的数组和总数在响应数据的字段位置 (即: `data.type.list`)

```json
{
   "list": "type.list",
   "total": "type.total"
}
```

#### 2.5 `binding` 数据绑定

关于 `binding` 字段的说明, 参考 [动态页面开发规范](./动态页面开发规范.md)

- 列表组件字段的命名尽量标准化，可参考[组件字段命名规范](./组件字段命名规范.md), 目的是使组件标准化, 不应不同项目变更, 然后不同业务通过`binding`进行配置

```json
{
  "binding":
  {
    "name": "title",
    "description": "desc"
  }
}
```

#### 2.6  `nodata` 没有数据
列表查询没有数据时展示的图文内容
```json
{
    "nodata": 
    {
        "url": "https://",
        "subject": “主题信息”,
        "note": "备注说明"
    }
}
```
 

## 3. 测试数据

GET /loadPageInfo?id=68

### 3.1 设计数据

```json
{
    "loadApi": "https://www.fastmock.site/mock/96df9e8fb08bfe844b3e565f5a3206fe/test/api/pub/getList",
    "tabConfig":
    {
      "field":"type",
      "show": true,
      "list":[
          {
              "name":"全部",
              "value":"0"
          },
          {
              "name":"时尚搭配",
              "value":"100"
          },
          {
            "name":"行业咨询",
            "value":"200"
          }
      ]
    },
    "response":
    {
        "list":"type.list",
        "total":"type.total"
    },
    "request":
    {
       "fixed":"type",
       "default":
        {
           "type":"0"
        },
       "pn":"pageNo",
       "ps":"pageSize"
    },
    "itemNavigation": "/articleDetail/index?id=&title",
    "itemModule":
    {
        "type":"custom_component",
        "name":"ArticleItem"
    },
    "binding": 
    {
      "title":"title",
      "desc":"desc"
    },
    "nodata": 
    {
        "url": "https://",
        "subject": "主题信息”,
        "note": "备注说明"
    }
}
```

### 3.2 业务数据

GET /?type=0

```json
{
  "code": 200,
  "data": {
    "type": {
      "list": [
        {
          "type": "100",
          "title": "的撒开发和建设的规100",
          "desc": "阿迪舒服哈森岛宽晃发的颂古非今阿萨德个发货速度发定时发送地方",
          "time": "2020-01-01",
          "img": "https://66861.s81i.faiusr.com/4/103/AFEIrYoEEAQYACDm84HWBSiN0KWQAjCKAjjHAUBn.png"
        },
        {
          "type": "200",
          "title": "的撒开发和建设的规200",
          "desc": "阿迪舒服哈森岛宽晃发的颂古非今阿萨德个发货速度发定时发送地方",
          "time": "2020-01-01",
          "img": "https://66861.s81i.faiusr.com/4/103/AFEIrYoEEAQYACDm84HWBSiN0KWQAjCKAjjHAUBn.png"
        }
      ],
      "total": 2
    }
  }
}
```
