## JSON 动态页面参数对照表

#### 1.概述

此文档是动态页面 JSON 参数说明文档，作为本项目动态页面对接的标准依据。

#### 2. 组件列表

- 动态表单组件(tag: autoform; )
- 动态列表组件(tag: autolist; )
- 页面跳转组件(tag: navlist; tagSize: medium; tagLayout: row|tab)
- 海报组件 (tag: banner; )


#### 3. JSON 主要配置说明

##### 3.1 根结构

| 属性            | 说明                                | 默认值   |
| --------------- | ---------------------------------- | -------- |
| id              | 设计布局数据索引ID                  |          |
| version         | 版本号                             | "1"      |
| name            | 页面名称 (其他页面路由跳转)          |         |
| title           | 页面标题栏标题                      |          |
| pageStyle       | 页面背景 (包括 background 等)       | {}       |
| moduleContainer | 各子组件外层统一容器风格             |  {}     |
| modules         | 页面组件集合                        | []       |
| moduleData      | 页面组件配置参数                    | {}       |
| dataSource      | 数据源配置                          | {}       |
| globalConfig    | 全局配置信息 (可仅返回此配置)        | {}       |

##### 3.2 关于 `moduleContainer` 与 `modules[0].container` 的说明
 动态页面子组件里面定义的 `container` 优先于页面定义的 `moduleContainer`, 如果子项没有定义 `container`, 即各个如果没有定义container的子组件采用页面里定义的moduleContainer, 有定义则忽略页面定义的 moduleContainer 而采用子组件定义的container；如果子组件定义了空的 `container:{}`, 即代表子组件不采用任何container风格。

##### 3.3 `modules` 列表项组件配置
> `binding` 用于组件直接由页面数据源绑定数据字段域

| 属性            | 说明                       | 默认值 |
| --------------- | --------------------------| ------ |
| type            | 组件类型                   |       |
| key             | 组件Key                    | uuid  |
| name            | 组件名称                   |       |
| binding         | 组件绑定数据源的字段名称或绑定集合  | {}   |
| bindingTarget   | 由`binding` 聚合为目标字段 |      |
| container       | 个性化组件外层容器风格      |  {}   |

###### 3.3.1 关于`binding`配置的详细说明
意思即是说，一个页面有多个组件，有几个组件可能都需要回显数据，那么假如三个组件就需要访问三个api, 很多时候，一个页面会只提供一个api包含了三个组件所需要的所有参数，这个时候各个需要从页面api获取参数的组件就通
过 `binding: {}` 字段进行数据绑定
> 举例说明, 表单组件会自已记问一次 loadApi,  但一般这个页面只提供一个api, 动态页面组件会通过`binding:{}` 设置把 页面 dataSource 返回的字段传给 动态表单， 动态表单获取了数据，loadApi 就不再访问了
>
> - `binding: {"gender": "sex"}`, 代表获取页面数据源返回的字段 gender (`dataSource.response.gender`) 绑定到组件的 sex 字段, 即 `{"gender": 'F' }` 传入子组件时为  `{"sex":'F'}`

###### 3.3.2 关于 `bindingTarget` 数据聚合的配置说明
如果 `bindingTarget: "data"`, 即 `binding": {"name":"name", "gender":"sex"}` 这样配置的话，传给子组件时变为 `{"data": {"name":"name", "gender":"sex"} }`,  聚合为 data 数据域

###### 3.3.3 关于`binding`数据展开的说明
与聚合相对，还有一个展开数据的概念， 如源数据是 `{"profile": {"name":"Jose", "gender":"F"} }` , 如果绑定配置为空`{}`, e.g. `"binding":{"profile":{}}` , 即传给子组件时变为 `{"name":"Jose", "gender":"F"}`
- `"binding": {"profile": {"gender": "sex"} }`  意思是先把 `gender` 绑定为 `sex`，再展开
- `"binding": {"profile": "userinfo" }` 仅仅绑定，不展开
- `"binding":  {"profile": "userinfo"，"profile.gender":"profile.sex" }`, 绑定数据域里面的字段，不展开

##### 3.4 `moduleData` 列表项组件配置
> `id` 与 `url` 只选其一，`id` 从固定的`endpoint`中获取
>
> `url` 可以为相对资源, 如 `?id=10` 代表从固定配置`endpoint`中增加 `?id=10` 参数

| 属性            | 说明                       | 默认值 |
| --------------- | --------------------------| ------ |
| id              | 组件设计数据获取 `id`       | {}   |
| url             | 组件设计数据获取 `url`      | {}   |

##### 3.5 `container`

| 属性         | 类型      | 说明              |
| ----------- | --------- | ----------------- |
| padding      | Style    | 内距              |
| margin       | Style    | 外边距            |
| fill         | Style    | 背景色            |
| stroke.color | Style    | 描边颜色          |
| stroke.lineWidth    | Style    |     描边线宽 |
| shadow.radius| Style    | 阴影大小 |
| shadow.color | Style    | 阴影颜色 |
| shadow.x     | Style    | 阴影位置 |
| shadow.y     | Style    | 阴影位置  |
| circle       | overlay  | 叠加圆形效果 |
| corner       | overlay  | 叠加圆角效果 |
| alignment    | Layout   | 对齐方式 |
| orientation  | Layout   | 排列方向 |
| justify      | Layout   | 子项对齐方式 |
| span         | Layout   | 子项跨度 |
| spacing      | Layout   | 子项间隔 |
| color        | Text     | 字体颜色 |
| font         | Text     | 字体     |
| lineLimit    | Text     | 字体长度限制 |
| multilineTextAlignment | Text | 多行字体对齐方式 |


##### 3.6 `dataSource` 响应字段
| 属性            | 说明                       | 默认值 |
| -------------- | --------------------------| ------ |
| api            | 业务数据源                  | "http://" |
| request        | 请求参数                    |  {}  |
| response       | 响应数据过滤                |  {}  |

##### 3.6.1 `dataSource.request` 响应字段
> 依据没`api` 自由定义

| 属性            | 说明                       | 默认值 |
| --------------- | --------------------------| ------ |
| type            | 请求参数                   |        |

##### 3.6.2 `dataSource.response` 响应字段
> 依据没`api` 自由定义

| 属性            | 说明                       | 默认值 |
| --------------- | --------------------------| ------ |
| data            | 过滤字段                   |        |
| total           | 过滤字段                   |       |


##### 3.6.2 `globalConfig` 全局配置信息

| 属性            | 说明                       | 默认值 |
| --------------- | --------------------------| ------ |
| useCache        | 是否缓存页面配置数据        | false  |


#### 4. JSON 测试数据

```json
{  
    "version": "1",
    "name": "page_home",
    "title": "场馆资讯",
    "pageStyle": {},
    "moduleContainer":{
      "padding": "10px",
      "margin": "10px",
      "fill": "white",
      "stroke": 
      {
         "color": "lightgray",
         "lineWidth": "1px"
      },
      "shadow":
      {
         "radius": 5
      },
      "corner": "8px",
      "spacing": "1em"
   },
  "modules": [
    {
      "type": "workdflow",
      "key": "df7b3702-cea0-11eb-b052-0800271e55b7",
      "name": "工作流组件",
    },
    {
      "type": "autolist",
      "key": "5243e64e-40ca-8b50-cdce-1623039409345",
      "name": "动态列表组件",
      "binding": 
      {
        "profile": {},
        "list":"list",
        "total":"total"
      },
      "bindingTarget": "data",
      "container":{}
    },
    {
      "type": "autoform",
      "key": "96afd71a-c8d5-11eb-aca5-0800271e55b7",
      "name": "动态表单组件",
      "container":{}
    }
  ], 
  "moduleData":
    {
        "df7b3702-cea0-11eb-b052-0800271e55b7":{
            "id": "68"
        },
        "5243e64e-40ca-8b50-cdce-1623039409345":
        {
          "loadApi": "https://www.fastmock.site/mock/96df9e8fb08bfe844b3e565f5a3206fe/test/api/pub/getList",
          "tabConfig":
          {
            "field":"type",
            "show": true,
            "list":[
                {
                    "name":"全部",
                    "value":"0"
                },
                {
                    "name":"时尚搭配",
                    "value":"100"
                },
                {
                  "name":"行业咨询",
                  "value":"200"
                }
            ]
          },
          "response":
          {
              "list":"type.list",
              "total":"type.total"
          },
          "request":
          {
            "fixed":"type",
            "default":
              {
                "type":"0"
              },
            "pn":"pageNo",
            "ps":"pageSize"
          },
          "itemNavigation": "/articleDetail/index?id=&title",
          "itemModule":
          {
              "name":"ArticleItem"
          },
          "binding":
          {
            "title":"title"
          }
        }, 
        "96afd71a-c8d5-11eb-aca5-0800271e55b7":{
           "url": "?id=10"
        }
    }
}
```